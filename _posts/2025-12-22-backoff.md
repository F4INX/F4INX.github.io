---
layout: post
title: Backoff calculations.
permalink: /posts/backoff.html
last_modified_at: 2025-12-22
---

<!-- TODO: more details in the title. -->

<p class="begin-note">Many thanks to my management at Eutelsat who kindly allowed me to republish this document I wrote for internal use here. Many thanks to my fellow colleagues for their help in this document.</p>

## Introduction

In many cases, an amplifier must process a signal containing multiple subcarriers. This occurs either due to multi-carrier modulation schemes or when an amplifier serves multiple users. To maintain sufficient linearity and minimize intermodulation distortion, a backoff is required between the average power of the amplified signal and the peak power of the amplifier. However, determining the appropriate backoff is not straightforward.

Existing rules of thumb do not provide a precise method to make a compromise between an high backoff, which wastes power, and a low backoff, which may not provide enough linearity. The peak to average power ratio (PAPR) is insufficient since it does not indicate how often peak levels are reached. Using reasonable approximations, this report aims to provide a simple and effective approach to backoff estimation.

## Modelling

The amplifier is modelled by the following transfer function of the complex amplitude, centred at the band’s centre frequency:

<latexmath>
y = x + \alpha \cdot \left|x\right|^2 \cdot x
</latexmath>

This approach is based on the works of Roblin and Versprecht.

The following assumptions are made:
 * Even-order terms are ignored since they produce out-of-band distortion.
 * Higher-order odd terms are considered negligible compared to third-order terms.
 * Conjugate terms correspond to reverse spectrum output signals, which are eliminated through filtering.
 * Gain is normalized to unity because all variables of interest are normalized to output (OIP3, P<sub>sat</sub>, …).
 * Units and impedances are ignored: <latexinline>\text{power}=\left|x\right|^2</latexinline>. No <latexinline>\sqrt{2}</latexinline> is present in the power formula because complex sinusoids are considered instead of real sinusoids.

## Parameters in function of OIP3

An input signal x consisting of two equal-amplitude complex sinusoids at angular frequencies <latexmath>ω_1</latexmath> and <latexmath>ω_2</latexmath> is considered:

<latexmath>
x = A \cdot \left( e^{j \cdot \omega_1 \cdot t} + e^{j \cdot \omega_2 \cdot t} \right)
</latexmath>

where A is the amplitude of each sinusoid.

To compute the tones produced by the transfer function:

<latexmath>
y = x + \alpha \cdot \left|x\right|^2 \cdot x
</latexmath>

The first step is to compute <latexinline>\left|x\right|^2</latexinline>:

<latexmath>
\begin{align*}
\left|x\right|^2 &= A \cdot \left( e^{j \cdot \omega_1 \cdot t} + e^{j \cdot \omega_2 \cdot t} \right) \cdot A \cdot \left( e^{-j \cdot \omega_1 \cdot t} + e^{-j \cdot \omega_2 \cdot t} \right)  \\
&= A^2 \left[ 2 + e^{j \cdot \left( \omega_1 - \omega_2 \right) \cdot t} + e^{j \cdot \left( \omega_2 - \omega_1 \right) \cdot t} \right]
\end{align*}
</latexmath>

The second step is to expand the non-linear term <latexinline>α \cdot \left|x\right|^2 \cdot x</latexinline>:

<latexmath>
\begin{multline*}
\alpha \cdot \left|x\right|^2 \cdot x = \alpha \cdot A^2 \left[ 2 + e^{j \cdot \left( \omega_1 - \omega_2 \right) \cdot t} + e^{j \cdot \left( \omega_2 - \omega_1 \right) \cdot t} \right] \cdot A \cdot \left( e^{j \cdot \omega_1 \cdot t} + e^{j \cdot \omega_2 \cdot t} \right)  \\
= \alpha \cdot A^3 \cdot \left[
    2 \cdot e^{j \cdot \omega_1 \cdot t}
    + 2 \cdot e^{j \cdot \omega_2 \cdot t}
    + e^{j \cdot \left(2 \cdot \omega_1 - \omega_2\right) \cdot t}
    + e^{j \cdot \omega_2 \cdot t}
    + e^{j \cdot \omega_1 \cdot t}
    + e^{j \cdot \left(\omega_1 - 2 \cdot \omega_2\right) \cdot t}
    \right]  \\
= \alpha \cdot A^3 \cdot \left[
    3 \cdot e^{j \cdot \omega_1 \cdot t}
    + 3 \cdot e^{j \cdot \omega_2 \cdot t}
    + e^{j \cdot \left(2 \cdot \omega_1 - \omega_2\right) \cdot t}
    + e^{j \cdot \left(\omega_1 - 2 \cdot \omega_2\right) \cdot t}
    \right]
\end{multline*}
</latexmath>

The total output can be split into fundamental and intermodulation components.
The total fundament part is:

<latexmath>
y_\text{fund} = A \cdot \left( 1 + 3 \cdot \alpha \cdot A \right) \cdot \left( e^{j \cdot \omega_1 \cdot t} + e^{j \cdot \omega_2 \cdot t} \right)
</latexmath>

Its amplitude is changed by the non-linear effects.
However, from the OIP3 definition, only the linear part should be taken:

<latexmath>
y_\text{lin} = A \cdot \left( e^{j \cdot \omega_1 \cdot t} + e^{j \cdot \omega_2 \cdot t} \right)
</latexmath>

and its RMS amplitude is:

<latexmath>
y_\text{lin} = A \cdot \sqrt{2}
</latexmath>

The total intermodulation part is:

<latexmath>
y_\text{imd} = \alpha \cdot A^3 \cdot \left[
    e^{j \cdot \left(2 \cdot \omega_1 - \omega_2\right) \cdot t}
    + e^{j \cdot \left(\omega_1 - 2 \cdot \omega_2\right) \cdot t}
    \right]
</latexmath>

and its RMS amplitude is:

<latexmath>
y_\text{imd} = \alpha \cdot A^3 \cdot \sqrt{2}
</latexmath>

The OIP3 is the (theoretical) amplitude A_OIP3 where A_lin=A_imd, i.e:

<latexmath>
A_\text{OIP3} \cdot \sqrt{2} = \alpha \cdot A^3 \cdot \sqrt{2}
</latexmath>

whose solution is easily:

<latexmath>
\alpha = \frac{1}{A_\text{OIP3}^2}
</latexmath>

## Non-linear power for a gaussian input

A multi-carrier signal, at both input and output, which may or may not be at the same frequency, is modelled by its complex amplitude centred on the device’s centre frequency:

<latexmath>
\begin{gather*}
x_\text{mod}(t) = \text{Re}\left[x(t) \cdot e^{j \cdot \omega_c \cdot t}\right]  \\
x(t) = x_1(t) + ... + x_n(t)  \\
x(t) = a_1(t) \cdot e^{j \cdot \omega_1 \cdot t} + ... + a_n(t) \cdot e^{j \cdot \omega_n \cdot t}  \\
\end{gather*}
</latexmath>

The complex amplitudes x_i (t) contains not only the base complex amplitudes of the signals a_i (t) but also the frequency shift ω_i-ω_c of each signal relative to the device’s centre frequency. a_i (t) can be modelled as a complex random variable **without** rotational symmetry. However, due to the frequency shift, x_i (t) can be modelled as a complex random variable **with** rotational symmetry.

The sum of the complex amplitudes x(t)=x_1 (t)+⋯+x_n (t) can be approximated by a zero-mean Gaussian probability distribution with a variance corresponding to its power. The following curve[^1], for a rolling dice, shows that starting from 3 rolls, the curve is close enough to gaussian.

[^1]: https://commons.wikimedia.org/wiki/File:Somme_n_tirages_pile_ou_face_1_a_12.svg

<!-- TODO: host it here. -->
![](https://upload.wikimedia.org/wikipedia/commons/5/50/Somme_n_tirages_pile_ou_face_1_a_12.svg)

To simplify calculations, the input/output power is normalized to 1, so:

<latexmath>
\sigma=\sqrt{\text{power}} = 1
</latexmath>

### Power of linear component

The linear part of the output is simply:

<latexmath>
y_\text{lin} = x
</latexmath>

which has a power of:

<latexmath>
\text{E}\left[\left|y_\text{lin}\right|^2\right] = \text{E}\left[\left|x\right|^2\right] = \sigma^2 = 1
</latexmath>

which is consistent with our normalization hypothesis.

### Power of non-linear component

The non-linear part of the output (including change in fundamental) is given by:

<latexmath>
y_\text{NL} = \alpha \cdot \left|x\right|^2 \cdot x
</latexmath>

whose power <latexinline>\text{E}\left[\left|y_\text{NL}\right|^2\right]</latexinline> can be calculated as follows:

<latexmath>
\begin{gather*}
\left|y_\text{NL}\right|^2 = \left|\alpha \cdot \left|x\right|^2 \cdot x\right|^2 = \alpha^2 \cdot \left|x\right|^6  \\
\text{E}\left[\left|y_\text{NL}\right|^2\right] = \left|\alpha\right|^2 \cdot \text{E}\left[\left|x\right|^6\right]  \\
\text{E}\left[\left|x\right|^6\right] = \text{E}\left[s^3\right] \quad \text{with} \quad s = \left|x\right|^2
\end{gather*}
</latexmath>

The total power of <latexinline>x</latexinline> is normalized to 1 so the power of its real and imaginary components are both <latexinline>\frac{1}{2}</latexinline>. In mathematical terms, <latexinline>x</latexinline> follows a standard complex normal distribution, so <latexinline>\text{Re}[x]</latexinline> and <latexinline>\text{Im}[x]</latexinline> both follow[^2] a normal distribution of variance <latexinline>\frac{1}{2}</latexinline>. Consequently, <latexinline>2 \cdot s</latexinline> follows a Chi-squared probability distribution[^3] with two degrees of freedom, itself equal to an exponential distribution of parameter <latexinline>\frac{1}{2}</latexinline>, whose moments can be calculated as such[^4]:

[^2]: https://en.wikipedia.org/wiki/Complex_normal_distribution
[^3]: https://en.wikipedia.org/wiki/Chi-squared_distribution
[^4]: https://en.wikipedia.org/wiki/Exponential_distribution

<latexmath>
\begin{gather*}
2 \cdot s \sim \chi_2^2 = \text{Exp}\left[\frac{1}{2}\right]  \\
\text{E}\left[\left(2 \cdot s\right)^3\right] = \frac{3!}{\left(\frac{1}{2}\right)^2} = 3! \cdot 2^3 = 48  \\
\text{E}\left[s^3\right] = \frac{48}{2^3} = 6
\end{gather*}
</latexmath>

Hence:

<latexmath>
\text{E}\left[\left|y_\text{NL}\right|^2\right] = 6 \cdot \left|\alpha\right|^2
</latexmath>

## Power of the non-linear component in function of the OIP3 and the backoff

Combining the previous results:

<latexmath>
P_\text{NL} = 6 \cdot \left|\alpha\right|^2 = 6 \cdot \frac{1}{A_\text{OIP3}^4}
</latexmath>

This can be expressed as dB, and since the output power is normalized as unity, these dB are in fact dBc:

<latexmath>
\begin{align*}
P_\text{NL,dBc} &= 10 \cdot \log_{10}\left(6\right) - 40 \cdot \log_{10}\left(A_\text{OIP3}\right)  \\
&= 10 \cdot \log_{10}\left(6\right) - 2 \cdot \text{OIP3}_\text{dBc}
\end{align*}
</latexmath>

Expressing the OIP3 in dBm:

<latexmath>
P_\text{NL,dBc} = 10 \cdot \log_{10}\left(6\right) + 2 \cdot (P_\text{out,dBm} - \text{OIP3}_\text{dBm})
</latexmath>

Reversing the equation:

<latexmath>
\text{OIP3}_\text{dBm} - P_\text{out,dBm} = \frac{10 \cdot \log_{10}\left(6\right)}{2} + \frac{1}{2} \cdot \left(-P_\text{NL,dBc}\right)
</latexmath>

The <latexinline>\text{OIP3}_\text{dBm}</latexinline> is less convenient to use than <latexinline>P_\text{sat}</latexinline>. However, the relation between the two depends a lot on the technology. Hence, we define <latexinline>\text{LF} = \text{OIP3}_\text{dBm} - P_\text{sat,dBm}</latexinline>, for "linearity factor", and plug it into the equation:

<latexmath>
P_\text{sat} - P_\text{out,dBm} = -\text{LF} + \frac{10 \cdot \log_{10}\left(6\right)}{2} + \frac{1}{2} \cdot \left(-P_\text{NL,dBc}\right)
</latexmath>

Hence:

<latexmath>
\text{OBO} = -\text{LF} + \frac{10 \cdot \log_{10}\left(6\right)}{2} + \frac{1}{2} \cdot \left(-P_\text{NL,dBc}\right)
</latexmath>

The <latexinline>\text{LF}</latexinline> is named linearity factor because the higher it is, the more linear is the amplifier.

## Values of the linearity factor LF for different technologies

The previous equations for the calculation need <latexinline>\text{LF} =\text{OIP3}_\text{dBm} - P_\text{sat,dBm}</latexinline>. To have estimates of its value, a review of several typical amplifiers was performed.

### TWTA

LF between 4 and 6:

<!-- FIXME: replace by global setting -->
<style>
    table.article-backoff {
        border-collapse: collapse;
        /* Centering */
        margin-left: auto;
        margin-right: auto;
    }
    table.article-backoff th, table.article-backoff td {
        border: 1px solid;
    }
    table.article-backoff th {
        text-align: center;
    }
</style>

<table class="article-backoff">
<tr><th>Mfg.</th><th>Name</th><th>Description</th><th>Psat [W]</th><th>Psat [dBm]</th><th>IM [dBc]</th><th>IM value at [dBm]</th><th>OIP3 [dBm]</th><th>OIP3 - Psat [dB]</th></tr>
<tr><td>CPI</td><td>T04UO-A1</td><td>400 W CW TWTA</td><td>400</td><td>56,0</td><td>-24,0</td><td>49,0</td><td>61,0</td><td>5,00</td></tr> 
<tr><td>CPI</td><td>TL07UO</td><td markdown="1">
750 W SuperLinear® TWTA[^5]
</td><td>750</td><td>58,8</td><td>-24,0</td><td>51,2</td><td>63,2</td><td>4,45</td></tr>
<tr><td>CPI</td><td>T07UO</td><td markdown="1">
750 W CW TWTA[^6]
</td><td>750</td><td>58,8</td><td>-24,0</td><td>51,1</td><td>63,1</td><td>4,35</td></tr>
<tr><td>CPI</td><td>TL12UO-A1</td><td markdown="1">
1.25 kW SuperLinear® TWTA (Air Cooled)[^7]
</td><td>1250</td><td>61,0</td><td>-25,0</td><td>54,3</td><td>66,8</td><td>5,84</td></tr>
<tr><td>CPI</td><td>TL12UO-L1</td><td>1.25 kW SuperLinear® TWTA (Liquid Cooled)</td><td>1250</td><td>61,0</td><td>-25,0</td><td>54,3</td><td>66,8</td><td>5,84</td></tr>
</table>

[^5]: https://www.cpii.com/docs/datasheets/817/tl07uo_mkt327.pdf
[^6]: https://www.cpii.com/docs/datasheets/817/MKT-285%202024%20rev%20V.pdf
[^7]: https://www.cpii.com/docs/datasheets/817/tl12uo-a1_mkt257.pdf


### TWTA with linearizer

Same products as before but with linearizer option. LF between 8 and 9:

<table class="article-backoff">
<tr><th>Mfg.</th><th>Name</th><th>Description</th><th>Psat [W]</th><th>Psat [dBm]</th><th>IM [dBc]</th><th>IM value at [dBm]</th><th>OIP3 [dBm]</th><th>OIP3 - Psat [dB]</th></tr>
<tr><td>CPI</td><td>T04UO-A1</td><td>400 W CW TWTA</td><td>400</td><td>56,0</td><td>-24,0</td><td>52,0</td><td>64,0</td><td>8,00</td></tr>
<tr><td>CPI</td><td>TL07UO</td><td>750 W SuperLinear® TWTA</td><td>750</td><td>58,8</td><td>-25,0</td><td>55,2</td><td>67,7</td><td>8,95</td></tr>
<tr><td>CPI</td><td>T07UO</td><td>750 W CW TWTA</td><td>750</td><td>58,8</td><td>-26,0</td><td>54,1</td><td>67,1</td><td>8,35</td></tr>
<tr><td>CPI</td><td>TL12UO-A1</td><td>1.25 kW SuperLinear® TWTA (Air Cooled)</td><td>1250</td><td>61,0</td><td>-25,0</td><td>57,3</td><td>69,8</td><td>8,85</td></tr>
<tr><td>CPI</td><td>TL12UO-L1</td><td>1.25 kW SuperLinear® TWTA (Liquid Cooled)</td><td>1250</td><td>61,0</td><td>-25,0</td><td>57,3</td><td>69,8</td><td>8,85</td></tr>
</table>

### SSPA

LF between 8 and 10:

<table class="article-backoff">
<tr><th>Mfg.</th><th>Name</th><th>Psat [W]</th><th>Psat [dBm]</th><th>IM [dBc]</th><th>IM value at [dBm]</th><th>OIP3 [dBm]</th><th>OIP3 - Psat [dB]</th></tr>
<tr><td>SpacePath</td><td markdown="1">
STS16[^8]
</td><td>20</td><td>43,0</td><td>-25,0</td><td>39,0</td><td>51,5</td><td>8,5</td></tr>
<tr><td>SpacePath</td><td markdown="1">
ST20[^9]
</td><td>25</td><td>44,0</td><td>-25,0</td><td>40,0</td><td>52,5</td><td>8,5</td></tr>
<tr><td>SpacePath</td><td markdown="1">
ST25K[^10]
</td><td>32</td><td>45,0</td><td>-25,0</td><td>41,0</td><td>53,5</td><td>8,5</td></tr>
<tr><td>SpacePath</td><td markdown="1">
STS250[^11]
</td><td>251</td><td>54,0</td><td>-25,0</td><td>51,0</td><td>63,5</td><td>9,5</td></tr>
<tr><td>SpacePath</td><td markdown="1">
STS300[^12]
</td><td>316</td><td>55,0</td><td>-25,0</td><td>52,0</td><td>64,5</td><td>9,5</td></tr>
<tr><td>SpacePath</td><td markdown="1">
STS400[^13]
</td><td>398</td><td>56,0</td><td>-25,0</td><td>53,0</td><td>65,5</td><td>9,5</td></tr>
<tr><td>SpacePath</td><td markdown="1">
STS500[^14]
</td><td>501</td><td>57,0</td><td>-25,0</td><td>54,0</td><td>66,5</td><td>9,5</td></tr>
<tr><td>Advantech</td><td markdown="1">
SapphireBlu[^15]
</td><td>1000</td><td>60,0</td><td>-25,0</td><td>56,5</td><td>69,0</td><td>9,0</td></tr>
</table>

[^8]: https://www.space-path.com/sites/default/files/document-downloads/Datasheet%2016%2020%2025W%20Ku%20Band.pdf
[^9]: https://www.space-path.com/sites/default/files/document-downloads/Datasheet%2016%2020%2025W%20Ku%20Band.pdf
[^10]: https://www.space-path.com/sites/default/files/document-downloads/Datasheet%2016%2020%2025W%20Ku%20Band.pdf
[^11]: https://www.space-path.com/sites/default/files/document-downloads/STS250%20300%20400%20500%20K.pdf
[^12]: https://www.space-path.com/sites/default/files/document-downloads/STS250%20300%20400%20500%20K.pdf
[^13]: https://www.space-path.com/sites/default/files/document-downloads/STS250%20300%20400%20500%20K.pdf
[^14]: https://www.space-path.com/sites/default/files/document-downloads/STS250%20300%20400%20500%20K.pdf
[^15]: https://advantechwireless.com/wp-content/uploads/2022/11/PB-SAPPH-2G-Ku-1000W-22245-LM.pdf

### SSPA with dubious linearization

To be continued. The example found has a surprisingly low LF.

<table class="article-backoff">
<tr><th>Mfg.</th><th>Name</th><th>Psat [W]</th><th>Psat [dBm]</th><th>IM [dBc]</th><th>IM value at [dBm]</th><th>OIP3 [dBm]</th><th>OIP3 - Psat [dB]</th></tr>
<tr><td>Teledyne</td><td markdown="1">
HPAK2600AHXXXXXG[^16]
</td><td>600</td><td>57,8</td><td>-25</td><td>54,8</td><td>67,3</td><td>9,5</td></tr>
</table>

[^16]: http://www.satcomsource.com/Teledyne-Paradise-Datacom-400W-Outdoor-Ku-Band-GAN-SSPA.pdf

## Calculated values of backoff for -20dBc

The value of LF depends on the technology but is surprisingly constant inside a given technology. It is this possible to calculate recommended backoff values for each technology.

<table class="article-backoff">
<tr><th>Technology</th><th>LF min</th><th>Back-off</th></tr>
<tr><td>TWTA</td><td>4</td><td>9,9</td></tr>
<tr><td>TWTA with linearizer</td><td>8</td><td>5,9</td></tr>
<tr><td>SSPA</td><td>8</td><td>5,9</td></tr>
</table>

<p></p>
